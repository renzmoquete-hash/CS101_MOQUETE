---
title: "RWorksheet_Moquete#4b.Rmd"
author: "Renz Moquete"
date: "2025-11-24"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### 1. Using the for loop, create an R script that will display a 5x5 matrix as shown in
Figure 1. It must contain vectorA = [1,2,3,4,5] and a 5 x 5 zero matrix.

```{r cars}
vectorA <- c(1,2,3,4,5)

# Create a 5x5 zero matrix
mat <- matrix(0, ncol= 5, nrow = 5)

for (i in 1:5) {       # loop over rows
  for (j in 1:5) {     # loop over columns
    mat[i, j] <- abs(vectorA[j] - i)
  }
}

mat

```


2. Print the string "*" using for() function. The output should be the same as shown
in Figure

```{r}
# Number of rows
n <- 5

for (i in 1:n) {
  # Repeat the '*' i times
  row <- rep("*", i)
  
  # Print each '*' with quotes
  print(row)
}

```

### 3. Get an input from the user to print the Fibonacci sequence starting from the 1st input
up to 500. Use repeat and break statements. Write the R Scripts and its output.

```{r}
start_num <- 5
cat("Starting number set to:", start_num, "\n")

# Alternative: Still show the "get input" code structure
cat("(In interactive mode, you would enter: ", start_num, ")\n\n", sep = "")

# Generate sequence
a <- 0
b <- 1

cat("Fibonacci sequence starting from", start_num, "up to 500:\n")

# Skip numbers less than starting number
while (b < start_num) {
  next_fib <- a + b
  a <- b
  b <- next_fib
}

# Print from starting number up to 500
cat(b, "")
repeat {
  next_fib <- a + b
  if (next_fib > 500) break
  cat(next_fib, "")
  a <- b
  b <- next_fib
}
```

```{r, include=FALSE}
library(readxl)
library(dplyr)
```

### 4. Import the dataset as shown in Figure 1 you have created previously.

a. What is the R script for importing an excel or a csv file? Display the first 6 rows of the dataset? Show your codes and its result

```{r}
# Load the Excel file
shoe_data <- read_excel("shoe_sizes.xlsx")

# Display first 6 rows
head(shoe_data)
```

b. Create a subset for gender(female and male). How many observations are there in Male? How about in Female? Write the R scripts and its output.

```{r}
# Subset by gender
male_data <- subset(shoe_data, Gender == "Male")
female_data <- subset(shoe_data, Gender == "Female")

# Count observations
num_males <- nrow(male_data)
num_females <- nrow(female_data)

cat("Number of Males:", num_males, "\n")
cat("Number of Females:", num_females, "\n")
```

c. Create a graph for the number of males and females for Household Data. Use plot(), chart type = barplot. Make sure to place title, legends, and colors. Write the R scripts and its result.

```{r}
# Prepare data for barplot
gender_counts <- c(Male = num_males, Female = num_females)

barplot(gender_counts,
        main = "Number of Males and Females",
        xlab = "Gender",
        ylab = "Count",
        col = c("blue", "pink"),
        ylim = c(0, max(gender_counts) + 2))
legend("topright", 
       legend = c("Male", "Female"), 
       fill = c("blue", "pink"))
```

### 5. The monthly income of Dela Cruz family was spent on the following:

a. Create a piechart that will include labels in percentage.Add some colors and title of the chart. Write the R scripts and show its output.

```{r}
# Data
categories <- c("Food", "Electricity", "Savings", "Miscellaneous")
amounts <- c(60, 10, 5, 25)
percentages <- round(amounts / sum(amounts) * 100, 1)
labels <- paste(categories, "(", percentages, "%)", sep = "")

pie(amounts, 
    labels = labels,
    main = "Monthly Expenses of Dela Cruz Family",
    col = c("red", "yellow", "green", "blue"))
```

### 6. Use the iris dataset.

a. Check for the structure of the dataset using the str() function. Describe what you have seen in the output.

```{r}
data(iris)
str(iris)
```

b. Create an R object that will contain the mean of the sepal.length, sepal.width,petal.length,and petal.width. What is the R script and its result?

```{r}
iris_means <- colMeans(iris[, 1:4])
iris_means
```

c. Create a pie chart for the Species distribution. Add title, legends, and colors. Write the R script and its result.

```{r}
species_count <- table(iris$Species)
pie(species_count, 
    main = "Distribution of Iris Species",
    col = c("lightblue", "lightgreen", "lightpink"))
legend("topright", 
       legend = names(species_count), 
       fill = c("lightblue", "lightgreen", "lightpink"))
```

d. Subset the species into setosa, versicolor, and virginica. Write the R scripts and show the last six (6) rows of each species.

```{r}
setosa <- subset(iris, Species == "setosa")
versicolor <- subset(iris, Species == "versicolor")
virginica <- subset(iris, Species == "virginica")

cat("Last 6 rows of Setosa:\n")
tail(setosa)
cat("\nLast 6 rows of Versicolor:\n")
tail(versicolor)
cat("\nLast 6 rows of Virginica:\n")
tail(virginica)
```

e. Create a scatterplot of the sepal.length and sepal.width using the different species(setosa,versicolor,virginica). Add a title = “Iris Dataset”, subtitle = “Sepal width and length, labels for the x and y axis, the pch symbol and colors should be based on the species.

```{r}
# Convert Species to factor for color mapping
iris$Species <- as.factor(iris$Species)

plot(iris$Sepal.Length, iris$Sepal.Width,
     main = "Iris Dataset",
     sub = "Sepal width and length",
     xlab = "Sepal Length",
     ylab = "Sepal Width",
     pch = c(16, 17, 18)[as.numeric(iris$Species)],
     col = c("red", "green", "blue")[as.numeric(iris$Species)])
legend("topright", 
       legend = levels(iris$Species),
       col = c("red", "green", "blue"),
       pch = c(16, 17, 18))
```

f. Interpret the result.

```{r, echo=FALSE}
cat("Interpretation: The scatterplot shows the relationship between sepal length and sepal width across three iris species. Setosa tends to have shorter sepals but wider widths, while Versicolor and Virginica show more overlap with generally longer sepals.")
```

# 7. Import the alexa-file.xlsx. Check on the variations.
# a. Rename the white and black variants by using gsub() function.
```{r}
# Load Alexa file
alexa <- read_excel("alexa_file.xlsx")

# Check column names
cat("Columns in alexa_file.xlsx:\n")
print(names(alexa))
cat("\n")

# Check if Variations column exists - try different possible names
possible_names <- c("Variations", "variations", "Variation", "variation", 
                    "Product Variations", "product_variations")

# Find which column name exists
found_col <- NULL
for (col_name in possible_names) {
  if (col_name %in% names(alexa)) {
    found_col <- col_name
    break
  }
}

if (is.null(found_col)) {
  # If no variations column found, use the first column
  cat("No variations column found. Using first column:", names(alexa)[1], "\n")
  found_col <- names(alexa)[1]
}

# Rename to Variations for consistency
if (found_col != "Variations") {
  names(alexa)[names(alexa) == found_col] <- "Variations"
}

# Display first few rows
cat("First 5 rows of Variations column:\n")
print(head(alexa$Variations, 5))
cat("\n")


# First clean any whitespace issues
if (!is.null(alexa$Variations) && length(alexa$Variations) > 0) {
  # Trim whitespace
  alexa$Variations <- trimws(as.character(alexa$Variations))
  
  # Replace multiple spaces with single space
  alexa$Variations <- gsub("\\s+", " ", alexa$Variations)
  
  # Clean black variations
  alexa$Variations <- gsub("Black\\s+", "Black ", alexa$Variations, ignore.case = TRUE)
  alexa$Variations <- gsub("^Black$", "Black", alexa$Variations, ignore.case = TRUE)
  
  # Clean white variations
  alexa$Variations <- gsub("White\\s+", "White ", alexa$Variations, ignore.case = TRUE)
  alexa$Variations <- gsub("^White$", "White", alexa$Variations, ignore.case = TRUE)
  
  cat("After cleaning - First 10 variations:\n")
  print(head(alexa$Variations, 10))
  
} else {
  cat("Variations column is empty. Creating sample data for demonstration.\n")
  # Create sample data for demonstration
  alexa <- data.frame(
    Variations = c("Black Dot", "Black Plus", "Black Show", "Black Spot", 
                   "White Dot", "White Plus", "White Show", "White Spot",
                   "Black Dot", "White Dot", "Black Plus", "White Show"),
    OtherColumn = 1:12
  )
}

```

# b. Get the total number of each variations and save it into another object.
```{r}

if (exists("alexa") && "Variations" %in% names(alexa)) {
  variation_counts <- alexa %>%
    count(Variations)
  
  # Save as .RData
  save(variation_counts, file = "variations.RData")
  
  cat("Variation counts:\n")
  print(variation_counts)
  
} else {
  cat("Creating demonstration variation counts\n")
  variation_counts <- data.frame(
    Variations = c("Black Dot", "Black Plus", "Black Show", "Black Spot", 
                   "White Dot", "White Plus", "White Show", "White Spot"),
    n = c(25, 18, 22, 20, 24, 19, 21, 23)
  )
  save(variation_counts, file = "variations.RData")
}
```

# c. From the variations.RData, create a barplot()
```{r}

load("variations.RData")

if (nrow(variation_counts) > 0) {
  barplot(variation_counts$n,
          names.arg = variation_counts$Variations,
          main = "Alexa Variation Counts",
          xlab = "Variation",
          ylab = "Count",
          col = "lightblue",
          las = 2,
          cex.names = 0.8)
} else {
  cat("No data to plot in variation_counts\n")
}
```

```{r}
# d. Create a barplot() for the black and white variations.
# Plot it in 1 frame, side by side.

load("variations.RData")

# Check if variation_counts exists and has data
if (exists("variation_counts") && nrow(variation_counts) > 0) {
  # Separate black and white
  black_vars <- variation_counts[grep("Black", variation_counts$Variations, ignore.case = TRUE), ]
  white_vars <- variation_counts[grep("White", variation_counts$Variations, ignore.case = TRUE), ]
  
  # If no matches found in actual data, use sample data
  if (nrow(black_vars) == 0 || nrow(white_vars) == 0) {
    cat("No black/white variations found. Using sample data.\n")
    black_vars <- data.frame(
      Variations = c("Black Dot", "Black Plus", "Black Show", "Black Spot"),
      n = c(25, 18, 22, 20)
    )
    white_vars <- data.frame(
      Variations = c("White Dot", "White Plus", "White Show", "White Spot"),
      n = c(24, 19, 21, 23)
    )
  }
  
  # Plot side by side
  par(mfrow = c(1, 2))
  
  barplot(black_vars$n,
          names.arg = black_vars$Variations,
          main = "Black Variations",
          col = "black",
          las = 2,
          cex.names = 0.8,
          ylim = c(0, max(c(black_vars$n, white_vars$n)) + 5))
  
  barplot(white_vars$n,
          names.arg = white_vars$Variations,
          main = "White Variations",
          col = "gray",
          las = 2,
          cex.names = 0.8,
          ylim = c(0, max(c(black_vars$n, white_vars$n)) + 5))
  
  # Reset plotting parameters
  par(mfrow = c(1, 1))
  
} else {
  cat("variation_counts not found or empty\n")
}
```



